# HubbleNego 単体利用 仕様書

> Negoを単独で利用する場合のユーザーフローと画面仕様を定義します。
> 共通仕様（AI機能、バージョン管理、署名・締結フロー、交渉詳細画面等）は [PRD_Common.md](./PRD_Common.md) を参照してください。

---

## 1. 概要

### 1.1 このパターンの対象ユーザー
- Hubbleを導入していない企業・個人
- 契約交渉ツールとしてNegoを単独で使いたいユーザー
- 取引先との契約書のやり取りを効率化したいビジネスパーソン

### 1.2 主な特徴
- 契約書をNegoに直接アップロード
- Negoが契約書の「マスター」となる
- 交渉相手はNegoに招待して参加

---

## 2. ユーザーフロー

### 2.1 メインフロー：契約交渉の開始から締結まで

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                  │
│  [1. アップロード]  →  [2. 招待]  →  [3. 交渉開始]              │
│        │                   │              │                      │
│        ↓                   ↓              ↓                      │
│   契約書を           相手を招待      AI解説を見ながら            │
│   ドラッグ＆         メール or       チャット・コメント          │
│   ドロップ           リンク共有      で交渉                      │
│                                           │                      │
│                                           ↓                      │
│                          [4. 署名手続き]  →  [5. 契約締結]        │
│                                  │              │                │
│                                  ↓              ↓                │
│                           署名者設定・      全員署名完了で       │
│                           署名依頼送信      契約締結              │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 2.2 招待された側のフロー

```
招待リンクを受信 → 契約書プレビュー確認 → サインイン → 交渉に参加
                     (AI概要表示)      (Google/Microsoft)
```

---

## 3. 画面構成

### 3.1 画面一覧

| 画面名 | 説明 | ファイル |
|--------|------|---------|
| サービスサイト | LP（プロダクト紹介） | website.html |
| 交渉一覧（ダッシュボード） | 全ての交渉を一覧表示 | index.html |
| 交渉詳細 | メイン交渉画面 | negotiation.html |
| 署名画面 | 署名依頼を受けた側の署名専用画面 | sign.html |
| 招待受領 | 招待リンクからのランディング | invite.html |
| 個人設定 | アカウント設定・通知設定 | settings.html |

> 交渉詳細画面・署名画面・招待受領画面の仕様は [PRD_Common.md](./PRD_Common.md) を参照。

### 3.2 画面遷移図

```
[サービスサイト] → [サインイン] → [交渉一覧]
                                       │
                                       ├── [+新しい交渉を始める] → ウィザード → [交渉詳細]
                                       │
                                       └── [交渉カードクリック] → [交渉詳細]
                                                                       │
                                                                       └── [署名手続き・設定] → [署名画面（相手側）]

[招待リンク] → [招待受領画面] → [サインイン] → [交渉詳細]
```

---

## 4. 交渉一覧画面（ダッシュボード）

### 4.1 画面レイアウト

```
┌─────────────────────────────────────────────────────────────────┐
│ HubbleNego          [検索]              [ユーザーアイコン]      │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  [+新しい交渉を始める]              [フィルター ▼] [ソート ▼]  │
│                                                                  │
│  ─────────── 交渉中（2件）───────────                           │
│  ┌──────────────────────────────────────────────────────────┐  │
│  │ 📄 業務委託契約書                              Ver.8     │  │
│  │    株式会社XYZ 田中様                最終更新: 1月28日    │  │
│  └──────────────────────────────────────────────────────────┘  │
│  ┌──────────────────────────────────────────────────────────┐  │
│  │ 📄 秘密保持契約書                              Ver.3     │  │
│  │    株式会社DEF 山田様               最終更新: 1月25日     │  │
│  └──────────────────────────────────────────────────────────┘  │
│                                                                  │
│  ─────────── 署名待ち（1件）───────────                         │
│  ┌──────────────────────────────────────────────────────────┐  │
│  │ 📄 販売代理店契約書                                      │  │
│  │    株式会社MNO 木村様             あなたの署名待ち        │  │
│  └──────────────────────────────────────────────────────────┘  │
│                                                                  │
│  ─────────── 締結済み（2件）───────────                         │
│  ...                                                             │
│                                                                  │
│  ▶ 中断（1件）                              ← デフォルト折りたたみ│
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 4.2 表示項目

| 項目 | 説明 |
|------|------|
| 契約書名 | 契約書のタイトル |
| 相手先 | 取引相手の会社名・担当者名 |
| バージョン | 現在のバージョン番号 |
| 最終更新 | 最後に更新された日時 |

### 4.3 機能
- 検索（契約書名、相手先で検索）
- フィルター（すべて / 交渉中 / 署名待ち / 締結済み / 中断）
- ソート（最新順 / 古い順 / 名前順）
- セクション分け（交渉中 / 署名待ち / 締結済み / 中断）

### 4.4 セクション表示順と折りたたみ

| セクション | 表示順 | デフォルト状態 | 説明 |
|-----------|-------|-------------|------|
| 交渉中 | 1 | 展開 | アクティブな交渉。最も注目度が高い |
| 署名待ち | 2 | 展開 | 署名アクションが必要 |
| 締結済み | 3 | 展開 | 完了した契約 |
| 中断 | 4 | **折りたたみ** | 中断された交渉。トグルで展開可能 |

> 中断セクションはデフォルトで折りたたまれており、ユーザーがクリックで展開する。アクティブな交渉に集中できるよう、終了した交渉のノイズを最小化する設計。

### 4.5 システムステータスとダッシュボードセクションのマッピング

PRD_Common.md §5.5 で定義されているシステムステータスと、ダッシュボード上のセクション表示の対応関係を明示する。

| システムステータス（§5.5） | ダッシュボードセクション | カード上の補足表示 |
|--------------------------|----------------------|------------------|
| `negotiating` | 交渉中 | 最終更新日時 |
| `signing_setup_done` | 署名待ち | 「署名依頼送信済み」 |
| `my_signer_signed` | 署名待ち | 「あなたの署名待ち」or「相手の署名待ち」（ロールにより分岐） |
| `concluded` | 締結済み | 締結日 |
| `suspended` | 中断 | 中断日＋中断理由（1行に切り詰め） |

> **署名待ちセクション内の表示順**: `my_signer_signed`（自分のアクションが不要）より `signing_setup_done`（相手の署名待ち）を上に表示。ユーザー自身の署名が必要な場合は最上部に配置し、カード上に「あなたの署名が必要です」バッジを表示する。

---

## 5. 新規交渉ウィザード

「+新しい交渉を始める」ボタンから起動する3ステップのウィザード。

### 5.1 Step 1: 契約書をアップロード

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                  │
│                     📤 契約書をアップロード                      │
│                                                                  │
│     ┌────────────────────────────────────────────────────┐     │
│     │                                                      │     │
│     │       ドラッグ＆ドロップ、または                    │     │
│     │       [ファイルを選択]                               │     │
│     │                                                      │     │
│     │       Word (.docx, .doc) / PDF                       │     │
│     │                                                      │     │
│     └────────────────────────────────────────────────────┘     │
│                                                                  │
│                                         [キャンセル] [次へ →]   │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

**仕様**
| 項目 | 仕様 |
|------|------|
| 対応形式 | Word (.docx, .doc), PDF |
| アップロード方法 | ドラッグ＆ドロップ / ファイル選択 |
| 複数ファイル | 対応（基本契約書＋個別契約書など） |
| ファイルサイズ上限 | 20MB/ファイル |
| プロジェクト名 | 最初のファイル名から自動生成 |

### 5.2 Step 2: 相手を招待

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                  │
│                        👥 相手を招待                             │
│                                                                  │
│  ──── メールアドレスで招待 ────                                  │
│  ┌────────────────────────────────────┐ [+]                     │
│  │ メールアドレスを入力...            │                          │
│  └────────────────────────────────────┘                          │
│                                                                  │
│  ──── または ────                                                │
│  🔗 招待リンクをコピー                                           │
│  ┌────────────────────────────────────┐ [コピー]                │
│  │ https://nego.app/join/x7k2mP9qL... │                          │
│  └────────────────────────────────────┘                          │
│  💡 招待された方は契約書を閲覧できます。                         │
│     編集にはサインインが必要です。                               │
│     ※ 署名者は署名手続き・設定で別途指定します。                │
│                                                                  │
│                                  [← 戻る] [スキップ] [次へ →]   │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 5.3 Step 3: 確認・開始

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                  │
│                  ✨ 交渉を開始する準備ができました               │
│                                                                  │
│  ──── 案件名 ────                                               │
│  ┌────────────────────────────────────────────────────┐ [✏️]  │
│  │ 業務委託基本契約書                                    │       │
│  └────────────────────────────────────────────────────┘       │
│                                                                  │
│  ──── 契約書 ────                                               │
│  📄 業務委託契約書.docx                                         │
│                                                                  │
│  ──── 招待 ────                                                 │
│  ✉️ tanaka@example.com                                           │
│                                                                  │
│                              [← 戻る] [キャンセル] [開始 →]    │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

- 案件名は最初のファイル名から自動生成されるが、この画面で編集可能
- 開始すると、招待した方にメールが送信される

---

## 6. デモファイル対応表

| 画面 | ファイル | 説明 |
|------|---------|------|
| サービスサイト | website.html | LP |
| 交渉一覧 | index.html | ダッシュボード + ウィザード |
| 交渉詳細 | negotiation.html | メイン交渉画面 |
| 署名画面 | sign.html | 署名専用画面 |
| 招待受領 | invite.html | 招待リンクからの入口 |
| 個人設定 | settings.html | 通知設定 |

---

## 7. スコープ外（意図的に対応しない機能）

| 機能 | 理由 |
|------|------|
| 組織・チーム管理 | Hubbleの価値領域。Negoは案件単位の交渉に特化する |
| 承認ワークフロー | 同上 |
| 組織横断のダッシュボード | 同上 |
| 管理者ロール | 同上 |
| テンプレート管理 | MVPではテンプレート機能を提供しない。ユーザーは手元のWordファイルをアップロードして交渉を開始する。テンプレートのニーズが確認された場合は Phase 2 で検討（Hubble連携ユーザーはHubble側のテンプレートを利用可能） |

> Negoで「チームで使いたい」ニーズが発生した場合、Hubbleへの導線で対応する。
> ただし、交渉単位でのメンバー追加（PRD_Common §8.3）は対応済みのため、「この交渉を同僚にも見せたい」は現行仕様で解決できる。

---

## 8. オンボーディング

初めてNegoにサインインしたユーザーが、最短で価値を体験できるようにする。

### 8.1 ダッシュボードの空の状態（Empty State）

初回サインイン直後はダッシュボードに交渉が存在しない。

```
┌─────────────────────────────────────────────────────────────────┐
│ HubbleNego          [検索]              [ユーザーアイコン]      │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│              📄 契約書をアップロードして、交渉を始めましょう      │
│                                                                  │
│          AIが契約書を要約し、チャットで交渉できます。             │
│                                                                  │
│              [＋ 新しい交渉を始める]（プライマリボタン）          │
│                                                                  │
│  ──── または ────                                                │
│  📩 招待された交渉がある場合は、メールの招待リンクから参加       │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

| 項目 | 仕様 |
|------|------|
| イラスト | 契約書のイラスト（親しみやすいデザイン） |
| メインCTA | 「＋ 新しい交渉を始める」（プライマリボタン、大サイズ） |
| サブテキスト | 「AIが契約書を要約し、チャットで交渉できます。」 |
| 招待誘導 | 「招待された交渉がある場合は、メールの招待リンクから参加」 |

### 8.2 交渉詳細画面の初回ガイダンス

交渉を作成した直後（相手がまだ参加していない状態）のガイダンス。

| 場所 | ガイダンス内容 |
|------|-------------|
| チャットタブ（プレースホルダー） | 「相手を招待すると、ここでチャットできます」 |
| AI分析カード（生成中） | 「AIが契約書を分析しています...」→ 完了後にカード内にサマリー表示 |
| バージョン履歴（1件のみ） | 初版バッジ＋「相手が編集版をアップロードすると、ここに表示されます」 |

> **設計思想**: モーダルやステップツアーは設けない。UI自体が文脈を語る設計（コンテクスチュアルヒント）で、ユーザーが自然に理解できるようにする。

---

## 9. 個人設定画面（settings.html）

グローバルヘッダーのユーザーアイコン → 「設定」から遷移する設定画面。

### 9.1 画面構成

```
┌─────────────────────────────────────────────────────────────────┐
│ ← 戻る        個人設定                                          │
├──────────────┬──────────────────────────────────────────────────┤
│              │                                                    │
│ プロフィール │  [選択中のセクションの内容]                       │
│ 通知         │                                                    │
│ セキュリティ │                                                    │
│ 友達紹介     │                                                    │
│ データ管理   │                                                    │
│ アカウント   │                                                    │
│              │                                                    │
└──────────────┴──────────────────────────────────────────────────┘
```

### 9.2 プロフィール

| 項目 | 仕様 |
|------|------|
| アバター | イニシャルアイコン（自動生成）。画像アップロードは将来対応 |
| 氏名 | 編集可能 |
| 会社名 | 編集可能（任意） |
| 部署・役職 | 編集可能（任意） |
| メールアドレス | OAuthプロバイダーから取得。変更不可（読み取り専用で表示） |

### 9.3 通知

PRD_Common.md §7.8 で定義されている通知設定を表示。

| カテゴリ | 説明 | デフォルト | 変更可否 |
|----------|------|-----------|---------|
| 相手からのアクション | 契約書の更新、コメント、メッセージ等 | 受け取る | ON/OFF可能 |
| 署名関連の通知 | 署名依頼、署名完了、契約締結 | 常に受け取る | 変更不可 |

### 9.4 セキュリティ

| 項目 | 仕様 |
|------|------|
| 接続中のアカウント | Google / Microsoft のどちらで認証しているかを表示 |
| ログインセッション | 現在のセッション情報（最終ログイン日時、デバイス情報）を表示。「他の全セッションをログアウト」ボタン |

### 9.5 友達紹介（Referral）

| 項目 | 仕様 |
|------|------|
| 紹介リンク | ユーザー固有の紹介URL。コピーボタン付き |
| 特典 | 紹介者・被紹介者ともにフリープランの制限を一時的に拡張（例: AI利用回数 +10回/月） |
| 紹介状況 | 紹介した人数・特典の残り期間を表示 |

### 9.6 データ管理

| 項目 | 仕様 |
|------|------|
| データエクスポート | 全交渉データの一括エクスポート（PRD_Common.md §15）。「エクスポートを開始」ボタン → バックグラウンド処理 → 完了後にダウンロードリンクをメール通知 |
| 利用状況 | 現在のストレージ使用量 / 上限を表示 |

### 9.7 アカウント

| 項目 | 仕様 |
|------|------|
| アカウント削除 | 「アカウントを削除」リンク（destructive style） → 確認モーダル → 「削除」で実行 |
| 削除の影響説明 | 確認モーダルにPRD_Common.md §13 のアカウント削除時の振る舞いを要約して表示 |
| 猶予期間 | 削除操作後30日間は復元可能。メールに復元リンクを含める |

---

## 10. 招待ユーザーの初回セットアップ体験

招待リンク経由で初めてNegoにアクセスするユーザーのフローと画面仕様。共通仕様はPRD_Common.md §8.6 を参照。

### 10.1 Nego単体利用における追加仕様

| 項目 | 仕様 |
|------|------|
| ダッシュボードへの反映 | 招待された交渉がダッシュボードに自動追加される。初めての交渉の場合、Empty State（§8.1）ではなく交渉が1件ある状態で表示 |
| 追加の交渉作成 | 招待ユーザーも自分で新しい交渉を作成可能。ダッシュボードの「＋ 新しい交渉を始める」ボタンから |
| 設定の初期状態 | 通知設定はデフォルト値が適用済み。プロフィールはOAuth + セットアップ画面（PRD_Common.md §8.6）で入力済みの情報が反映 |

---

**Document Version:** 3.0
**Last Updated:** 2026-02-21
