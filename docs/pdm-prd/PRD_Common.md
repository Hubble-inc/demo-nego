# HubbleNego 共通仕様書

> このドキュメントは、Nego単体利用・Hubble連携利用の両方に共通する仕様を定義します。
> - Nego単体利用の詳細 → [PRD_Nego_Standalone.md](./PRD_Nego_Standalone.md)
> - Hubble連携利用の詳細 → [PRD_Nego_Hubble.md](./PRD_Nego_Hubble.md)

---

## 1. プロダクト概要

### 1.1 プロダクトビジョン
> **「契約がわかると、信頼される。」**

AIが契約書を「あなたの言葉」に翻訳し、理解して交渉し、守れる約束を結ぶ。それが次のビジネスを生む。

### 1.2 解決する課題

| 課題 | 現状 | HubbleNegoによる解決 |
|------|------|----------------------|
| 契約書が難しい | 法律用語が理解できず、何を約束しているのかわからない | AIが平易な日本語に翻訳、要点を3行でサマリー |
| 交渉に時間がかかる | メールの往復で認識のズレが発生、締結まで長期化 | 同じ画面でリアルタイム交渉、コメント・チャットで即解決 |
| 期日を忘れる | 更新判断期限を見落とし、意図しない自動更新 | タイムラインで可視化、自動リマインド |
| 版管理が混乱 | 「最新版どれ？」問題、変更履歴が追えない | 自動バージョン管理、差分比較機能 |

### 1.3 ターゲットユーザー

#### プライマリペルソナ
**「契約書を扱う必要があるが、法務の専門家ではないビジネスパーソン」**

- 営業マネージャー（取引先との契約交渉）
- 事業開発担当者（パートナーシップ契約）
- スタートアップ経営者（各種契約を自分で対応）
- フリーランス・個人事業主（業務委託契約）

#### セカンダリペルソナ
- 法務担当者（複数の契約を効率的に管理）
- 管理部門担当者（契約期限・支払いの管理）

---

## 2. AI機能

### 2.1 契約書サマリー（自動生成）

| 機能 | 説明 |
|------|------|
| 要点サマリー | 契約の要点を3行で自動生成 |
| 人・モノ・金の流れ | 当事者間の取引構造を図示 |
| タイムライン | 重要日付（開始・満了・更新判断期限・請求日等）を自動抽出 |
| ハイライト | 金額・期間・責任範囲を自動でマーク |

### 2.2 AI解説機能

| 機能 | 説明 |
|------|------|
| テキスト選択解説 | 選択した条文を平易な日本語で解説 |
| 注意点の提示 | リスクや注意すべきポイントをアラート表示 |
| 質問応答 | 契約内容についてAIに質問可能（将来機能） |

### 2.3 AI生成物の表示ルール
- 全てのAI生成コンテンツに「AI生成」バッジを表示
- 「契約書から自動生成されています。内容をご確認ください。」の注記

---

## 3. リアルタイム交渉機能

### 3.1 メッセージ（チャット）

| 項目 | 仕様 |
|------|------|
| リアルタイム送受信 | 対応 |
| 送信者表示 | アバター（イニシャル）＋名前＋タイムスタンプ |
| 既読機能 | 将来対応 |
| 通知 | メール通知（新着メッセージ時） |

### 3.2 コメントスレッド

| 項目 | 仕様 |
|------|------|
| 対象 | 契約書内の任意のテキストに紐付け |
| スレッド形式 | 1コメントに対して複数の返信が可能 |
| 表示 | 契約書本文にコメントアイコン＋件数を表示 |
| アクセス | アイコンクリックでスレッドパネル表示 |

---

## 4. バージョン管理

### 4.1 自動バージョニング

| 項目 | 仕様 |
|------|------|
| バージョン作成タイミング | ファイルアップロード時に自動作成 |
| 表示情報 | バージョン番号、編集者名、日時、変更概要 |
| 初版・最新の表示 | バッジで明示 |

### 4.2 バージョン比較

| 項目 | 仕様 |
|------|------|
| 比較方法 | 2つのバージョンをチェックボックスで選択 |
| 差分表示 | 変更箇所をハイライト（追加:緑 / 削除:赤） |
| 差分モーダル | 変更前後を並べて表示 |

### 4.3 Wordファイル編集連携

| 項目 | 仕様 |
|------|------|
| ダウンロード | 現在のバージョンをWordでダウンロード |
| アップロード | 編集済みWordをアップロードして新バージョン作成 |
| 差分確認 | アップロード時に変更内容をプレビュー |

---

## 5. 合意フロー

### 5.1 合意プロセス

```
[自分が合意] → [相手方の合意待ち] → [両者合意で契約成立]
     ↓                 ↓                    ↓
「この内容で      ステータスバナーで    紙吹雪演出で
 合意」ボタン     待機状態を表示        成立を祝福
```

### 5.2 ステータス管理

| ステータス | 説明 |
|-----------|------|
| 交渉中 | 契約内容を協議中 |
| 返答待ち | 相手からのレスポンス待ち |
| 相手方合意待ち | 自分は合意済み、相手の合意を待機 |
| 合意済み | 両者が合意し契約成立 |

### 5.3 合意後のアクション
- 契約書のダウンロード
- 契約書の編集ロック

---

## 6. 期日・タイムライン管理

### 6.1 自動抽出される日付

| 日付タイプ | 説明 |
|-----------|------|
| 契約開始日 | 契約の効力発生日 |
| 契約満了日 | 契約の終了日 |
| 更新判断期限 | 自動更新を止めるための通知期限 |
| 請求書発行日 | 月次等の請求日 |
| 支払期日 | 報酬の支払い期限 |

### 6.2 タイムライン表示
- 時系列でイベントを一覧表示
- 完了/今月/毎月/重要などのバッジ表示
- カウントダウン表示（更新判断期限まで「あとX日」）

### 6.3 リマインド通知

| 項目 | 仕様 |
|------|------|
| 通知タイミング選択肢 | 4週間前 / 2週間前 / 1週間前（デフォルト）/ 3日前 / 1日前 |
| 通知方法 | メール、ブラウザ通知（将来：Slack/Teams連携） |

---

## 7. 通知設計

### 7.1 設計思想

| 原則 | 説明 |
|------|------|
| ズボラな人向け | デフォルト設定のまま何もしなくても適切な通知が届く |
| こだわりたい人向け | 交渉ごとに「重要マーク」で優先度を調整可能 |
| 通知疲れ防止 | 編集+コメントをまとめて1通にするなど、通知数を最小化 |

### 7.2 個人設定（グローバル設定）

| カテゴリ | 説明 | デフォルト |
|----------|------|-----------|
| 相手からのアクション | 契約書の更新、コメント、署名リクエストなど、相手方からのアクションがあった時に通知。編集とコメントが同時の場合は、1通にまとめてお届け | 受け取る |
| 期限のリマインド | 相手先との交渉で設定した期限が近づくとお知らせ。※契約台帳に直接登録した契約は対象外 | 受け取る |
| 契約更新・解約通知期限お知らせメール（毎月1日配信） | 更新・解約通知期限が迫っている契約書の件数をお知らせ（契約終了日と契約更新・解約通知期限の双方が入力されたドキュメントが対象） | 受け取る |

### 7.3 通知のまとめロジック（バッチウィンドウ方式）

同一人物が5分以内に行った複数のアクション（編集+コメントなど）は1通にまとめて通知。

| 条件 | まとめる？ |
|------|----------|
| 同じ人が5分以内に複数アクション | ✅ まとめる |
| 違う人のアクション | ❌ 別々に通知 |
| 署名リクエスト | ❌ 常に即時通知（重要なため例外） |

### 7.4 重要な交渉としてマーク（交渉ごとの設定）

| 項目 | 仕様 |
|------|------|
| 設定場所 | 交渉画面 > 管理タブ > この交渉の通知 |
| 効果 | 通知メールの件名に [重要] が付く |
| デフォルト | オフ（マークなし） |

---

## 8. 招待・権限管理

### 8.1 招待方法

| 方法 | 説明 |
|------|------|
| メールアドレス招待 | メールアドレスを入力して招待 |
| リンク共有 | 招待URLをコピーして共有 |

### 8.2 権限タイプ

| 権限 | 説明 |
|------|------|
| 合意権限あり（Signer） | 契約への合意が可能、閲覧・編集・コメント可能 |
| メンバー（Member） | 閲覧・編集・コメントのみ、合意は不可 |

---

## 9. 非機能要件

### セキュリティ

| 項目 | 要件 |
|------|------|
| 認証 | OAuth 2.0（Google, Microsoft） |
| 通信 | HTTPS必須 |
| データ暗号化 | 保存データの暗号化 |
| アクセス制御 | 招待されたメンバーのみアクセス可能 |

### パフォーマンス

| 項目 | 目標値 |
|------|--------|
| ページロード | 3秒以内 |
| AI解説生成 | 5秒以内 |
| ファイルアップロード | 20MB/30秒以内 |

### 可用性

| 項目 | 目標値 |
|------|--------|
| 稼働率 | 99.9% |
| バックアップ | 日次バックアップ |

### 対応環境

| 項目 | 対応範囲 |
|------|---------|
| ブラウザ | Chrome, Safari, Edge, Firefox（最新2バージョン） |
| デバイス | PC（レスポンシブ対応でタブレットも可） |

---

## 10. 用語集

| 用語 | 定義 |
|------|------|
| 交渉 | 契約書に対する協議・調整の単位 |
| バージョン | 契約書の版数。アップロードごとに自動インクリメント |
| 合意 | 契約内容に同意すること。両者の合意で契約成立 |
| メンバー | 交渉に参加している人（自分＋招待した相手） |
| 合意権限 | 「この内容で合意」を押す権限 |

---

**Document Version:** 1.0
**Last Updated:** 2026-02-03
